<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìö –†–µ–¥–∞–∫—Ç–æ—Ä –≥–ª–æ—Å—Å–∞—Ä–∏—è</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            margin: 0;
            padding: 0;
            background: #f8f9fa;
            color: #333;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            min-height: 100vh;
        }
        
        /* –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ - –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ –∫–Ω–æ–ø–∫–∏ */
        .header-bar {
            background: #fff;
            border-bottom: 1px solid #e1e4e8;
            padding: 16px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
        }
        
        .logo {
            display: flex;
            align-items: center;
            font-weight: 600;
            font-size: 20px;
            color: #24292e;
        }
        
        .logo-icon {
            margin-right: 10px;
            font-size: 24px;
        }
        
        .header-actions {
            display: flex;
            gap: 10px;
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            padding: 8px 16px;
            font-size: 14px;
            font-weight: 500;
            border-radius: 6px;
            border: 1px solid transparent;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
        }
        
        .btn-default {
            color: #24292e;
            background: #f6f8fa;
            border-color: rgba(27,31,36,0.15);
        }
        
        .btn-default:hover {
            background: #f3f4f6;
            border-color: rgba(27,31,36,0.25);
        }
        
        .btn-primary {
            color: white;
            background: #2da44e;
            border-color: rgba(27,31,36,0.15);
        }
        
        .btn-primary:hover {
            background: #2c974b;
            border-color: rgba(27,31,36,0.25);
        }
        
        .btn-icon {
            margin-right: 6px;
        }
        
        /* –í—Ç–æ—Ä–∞—è —Å—Ç—Ä–æ–∫–∞ - —Å—Ç–∞—Ç—É—Å, —Ñ–∞–π–ª –∏ –ø–æ–∏—Å–∫ */
        .status-bar {
            background: #f6f8fa;
            padding: 12px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid #e1e4e8;
            flex-wrap: wrap;
            gap: 15px;
            position: sticky;
            top: 60px; /* –í—ã—Å–æ—Ç–∞ header-bar */
            z-index: 99;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
        }
        
        .file-info {
            display: flex;
            align-items: center;
            font-size: 14px;
            color: #656d76;
        }
        
        .file-name {
            background: #fff;
            padding: 4px 10px;
            border-radius: 4px;
            border: 1px solid #d1d9e0;
            font-style: italic;
            max-width: 300px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .file-time {
            margin-left: 8px;
            font-size: 12px;
            color: #656d76;
        }
        
        .search-container {
            flex: 1;
            max-width: 400px;
            position: relative;
        }
        
        .search-input {
            width: 100%;
            padding: 8px 32px 8px 12px;
            font-size: 14px;
            border: 1px solid #d1d9e0;
            border-radius: 6px;
            background: white;
            transition: all 0.2s ease;
        }
        
        .search-input:focus {
            outline: none;
            border-color: #0969da;
            box-shadow: 0 0 0 3px rgba(9,105,218,0.1);
        }
        
        .search-btn {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: #656d76;
            cursor: pointer;
            padding: 4px;
        }
        
        /* –¢—Ä–µ—Ç—å—è —á–∞—Å—Ç—å - —Ç–∞–±–ª–∏—Ü–∞ —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º */
        .content {
            padding: 20px;
        }
        
        /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∞–±–ª–∏—Ü—ã —Ç–µ–ø–µ—Ä—å –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç wrapper */
        .table-header {
            padding: 16px 20px;
            background: #f6f8fa;
            border-bottom: 1px solid #d1d9e0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 100px; /* –í—ã—Å–æ—Ç–∞ header-bar + status-bar */
            z-index: 98;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
            border-radius: 8px 8px 0 0;
            margin-bottom: 0;
        }
        
        .table-title {
            font-size: 16px;
            font-weight: 600;
            color: #24292e;
            display: flex;
            align-items: center;
        }
        
        .table-title-icon {
            margin-right: 10px;
            font-size: 20px;
        }
        
        .add-term-btn {
            display: inline-flex;
            align-items: center;
            padding: 6px 12px;
            font-size: 13px;
            font-weight: 500;
            border-radius: 6px;
            border: 1px solid transparent;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
            color: #0969da;
            background: #f0f8ff;
            border-color: rgba(9,105,218,0.1);
        }
        
        .add-term-btn:hover {
            background: #e6f3ff;
            border-color: rgba(9,105,218,0.2);
        }
        
        .table-wrapper {
            background: white;
            border-radius: 0 0 8px 8px;
            border: 1px solid #d1d9e0;
            border-top: none;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th, td {
            padding: 12px 16px;
            text-align: left;
            border-bottom: 1px solid #d1d9e0;
        }
        
        th {
            font-weight: 600;
            font-size: 12px;
            color: #656d76;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            background: #f8f9fa;
        }
        
        tr:hover {
            background: #f6f8fa;
        }
        
        .action-cell {
            width: 100px;
        }
        
        .action-buttons {
            display: flex;
            gap: 4px;
        }
        
        .icon-btn {
            width: 28px;
            height: 28px;
            border-radius: 4px;
            border: 1px solid transparent;
            background: transparent;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }
        
        .icon-btn:hover {
            background: #f3f4f6;
            border-color: rgba(0,0,0,0.1);
        }
        
        .icon-btn.edit:hover {
            background: #fff8dc;
            border-color: #f0ad4e;
            color: #8a6d3b;
        }
        
        .icon-btn.delete:hover {
            background: #ffebe9;
            border-color: #ff8787;
            color: #d1242f;
        }
        
        .icon-btn.save:hover {
            background: #dafbe1;
            border-color: #2da44e;
            color: #1a7f37;
        }
        
        .icon-btn.cancel:hover {
            background: #f1f3f5;
            border-color: #d1d9e0;
            color: #656d76;
        }
        
        /* Inline —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ */
        .inline-edit {
            width: 100%;
            padding: 6px 8px;
            border: 1px solid #d1d9e0;
            border-radius: 4px;
            font-size: 14px;
            font-family: inherit;
        }
        
        .inline-edit:focus {
            outline: none;
            border-color: #0969da;
            box-shadow: 0 0 0 3px rgba(9,105,218,0.1);
        }
        
        .inline-select {
            width: 100%;
            padding: 6px 8px;
            border: 1px solid #d1d9e0;
            border-radius: 4px;
            font-size: 14px;
            font-family: inherit;
            background: white;
            cursor: pointer;
        }
        
        /* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –Ω–æ–≤–æ–≥–æ —Ç–µ—Ä–º–∏–Ω–∞ */
        .new-indicator {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            background: #1a7f37;
            color: white;
            border-radius: 50%;
            font-size: 12px;
            font-weight: bold;
        }
        
        /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 12px 16px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            box-shadow: 0 3px 12px rgba(0,0,0,0.15);
            z-index: 1000;
            max-width: 300px;
            animation: slideIn 0.3s ease, slideOut 0.3s ease 2.7s;
            animation-fill-mode: forwards;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }
        
        .notification.success {
            background: #dafbe1;
            color: #1a7f37;
            border: 1px solid #2da44e;
        }
        
        .notification.error {
            background: #ffebe9;
            color: #d1242f;
            border: 1px solid #ff8787;
        }
        
        /* –ü—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #656d76;
        }
        
        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.3;
        }
        
        .empty-state h3 {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #24292e;
        }
        
        .empty-state p {
            font-size: 14px;
            margin-bottom: 16px;
        }
        
        /* –°–∫—Ä—ã—Ç—ã–π —Ñ–∞–π–ª–æ–≤—ã–π –∏–Ω–ø—É—Ç */
        .file-input {
            display: none;
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .header-bar {
                flex-direction: column;
                gap: 10px;
                align-items: flex-start;
            }
            
            .header-actions {
                width: 100%;
                justify-content: flex-start;
            }
            
            .status-bar {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
                top: 90px; /* –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –¥–ª—è –º–æ–±–∏–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏ */
            }
            
            .table-header {
                top: 140px; /* –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –¥–ª—è –º–æ–±–∏–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏ */
            }
            
            .search-container {
                width: 100%;
                max-width: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ - –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ –∫–Ω–æ–ø–∫–∏ -->
        <div class="header-bar">
            <div class="logo">
                <span class="logo-icon">üìö</span>
                –†–µ–¥–∞–∫—Ç–æ—Ä –≥–ª–æ—Å—Å–∞—Ä–∏—è
            </div>
            
            <div class="header-actions">
                <label for="fileInput" class="btn btn-default">
                    <span class="btn-icon">üìÇ</span>
                    –í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª
                </label>
                <input type="file" id="fileInput" class="file-input" accept=".json">
                
                <button class="btn btn-primary" onclick="exportGlossary()">
                    <span class="btn-icon">üíæ</span>
                    –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≥–ª–æ—Å—Å–∞—Ä–∏–π
                </button>
            </div>
        </div>
        
        <!-- –í—Ç–æ—Ä–∞—è —Å—Ç—Ä–æ–∫–∞ - —Å—Ç–∞—Ç—É—Å, —Ñ–∞–π–ª –∏ –ø–æ–∏—Å–∫ -->
        <div class="status-bar">
            <div class="file-info">
                <span class="file-name" id="glossaryName">–ù–µ –∑–∞–≥—Ä—É–∂–µ–Ω</span>
                <span class="file-time" id="fileTime"></span>
            </div>
            
            <div class="search-container">
                <input type="text" class="search-input" id="searchInput" placeholder="–ü–æ–∏—Å–∫ —Ç–µ—Ä–º–∏–Ω–æ–≤...">
                <button class="search-btn" onclick="searchTerm()">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 6.5 0 0 1 11 0z"/>
                    </svg>
                </button>
            </div>
        </div>
        
        <!-- –¢—Ä–µ—Ç—å—è —á–∞—Å—Ç—å - —Ç–∞–±–ª–∏—Ü–∞ —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º -->
        <div class="content">
            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∞–±–ª–∏—Ü—ã —Ç–µ–ø–µ—Ä—å –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç wrapper -->
            <div id="tableHeader" class="table-header" style="display: none;">
                <div class="table-title">
                    <span class="table-title-icon">üìö</span>
                    –¢–µ—Ä–º–∏–Ω—ã –≥–ª–æ—Å—Å–∞—Ä–∏—è
                </div>
                <button class="add-term-btn" onclick="addNewTerm()">
                    <span class="btn-icon">‚ûï</span>
                    –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Ä–º–∏–Ω
                </button>
            </div>
            
            <div id="tableContainer" class="table-wrapper" style="display: none;">
                <table>
                    <thead>
                        <tr>
                            <th>–û—Ä–∏–≥–∏–Ω–∞–ª</th>
                            <th>–ü–µ—Ä–µ–≤–æ–¥ (–∏–º.–ø.)</th>
                            <th>–ü–µ—Ä–µ–≤–æ–¥ (—Ä–æ–¥.–ø.)</th>
                            <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                            <th>–¢–∏–ø</th>
                            <th>–ù–æ–≤–æ–µ</th>
                            <th class="action-cell">–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody id="termsTableBody">
                    </tbody>
                </table>
            </div>
            
            <!-- –ü—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ -->
            <div id="emptyState" class="empty-state">
                <div class="empty-state-icon">üìÑ</div>
                <h3>–ì–ª–æ—Å—Å–∞—Ä–∏–π –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω</h3>
                <p>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –≥–ª–æ—Å—Å–∞—Ä–∏—è –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã</p>
            </div>
        </div>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        let glossary = {
            metadata: {
                version: "15.0",
                last_updated: new Date().toISOString(),
                editor: "–í–∞—à–µ –ò–º—è"
            },
            terms: [] // –ú–∞—Å—Å–∏–≤ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–µ—Ä–º–∏–Ω–æ–≤ –≥–ª–æ—Å—Å–∞—Ä–∏—è
        };
        
        let currentEditIndex = -1; // –ò–Ω–¥–µ–∫—Å —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º–æ–≥–æ —Ç–µ—Ä–º–∏–Ω–∞ (-1 –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –Ω–∏—á–µ–≥–æ –Ω–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç—Å—è)
        let currentFileName = ''; // –ò–º—è —Ç–µ–∫—É—â–µ–≥–æ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
        let currentFileTime = ''; // –í—Ä–µ–º—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ —Ñ–∞–π–ª–∞
        let isNewTerm = false; // –§–ª–∞–≥ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ —Ç–µ—Ä–º–∏–Ω–∞
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ DOM
        document.addEventListener('DOMContentLoaded', function() {
            // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ —Å–æ–±—ã—Ç–∏—è –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞
            const fileInput = document.getElementById('fileInput');
            fileInput.addEventListener('change', handleFileSelect);
            
            // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ —Å–æ–±—ã—Ç–∏—è –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ –Ω–∞–∂–∞—Ç–∏—é Enter
            const searchInput = document.getElementById('searchInput');
            searchInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    searchTerm();
                }
            });
            
            // –ù–∞—á–∞–ª—å–Ω–∞—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
            updateUI();
        });
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞ –≥–ª–æ—Å—Å–∞—Ä–∏—è
        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ñ–∞–π–ª–µ
            currentFileName = file.name;
            currentFileTime = new Date(file.lastModified).toLocaleString();
            
            // –ß—Ç–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º FileReader API
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    // –ü–∞—Ä—Å–∏–Ω–≥ JSON —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Ñ–∞–π–ª–∞
                    glossary = JSON.parse(e.target.result);
                    
                    // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø—É—Å—Ç—ã—Ö —Ç–µ—Ä–º–∏–Ω–æ–≤ (–±–µ–∑ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π)
                    glossary.terms = glossary.terms.filter(term => 
                        term.original && term.original.trim() !== '' && 
                        term.translations && term.translations.nominative && term.translations.nominative.trim() !== ''
                    );
                    
                    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏
                    updateUI();
                    showNotification('–ì–ª–æ—Å—Å–∞—Ä–∏–π —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω', 'success');
                } catch (error) {
                    showNotification('–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞: ' + error.message, 'error');
                }
            };
            reader.readAsText(file);
        }
        
        // –≠–∫—Å–ø–æ—Ä—Ç –≥–ª–æ—Å—Å–∞—Ä–∏—è –≤ —Ñ–∞–π–ª JSON
        function exportGlossary() {
            if (!glossary.terms || glossary.terms.length === 0) {
                showNotification('–ì–ª–æ—Å—Å–∞—Ä–∏–π –ø—É—Å—Ç –∏–ª–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω', 'error');
                return;
            }
            
            // –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–ø–∏–∏ –≥–ª–æ—Å—Å–∞—Ä–∏—è –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞
            const exportGlossary = {
                metadata: glossary.metadata,
                terms: glossary.terms.map(term => {
                    // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–ª–µ–π —Ç–µ—Ä–º–∏–Ω–∞
                    const exportTerm = {...term};
                    return exportTerm;
                })
            };
            
            // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ –≤ —Å—Ç—Ä–æ–∫—É JSON
            const dataStr = JSON.stringify(exportGlossary, null, 2);
            const blob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            
            // –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ —Å —Ç–µ–∫—É—â–µ–π –¥–∞—Ç–æ–π –∏ –≤—Ä–µ–º–µ–Ω–µ–º
            const now = new Date();
            const dateStr = now.getFullYear().toString().slice(2) + 
                          (now.getMonth()+1).toString().padStart(2, '0') + 
                          now.getDate().toString().padStart(2, '0') + 
                          now.getHours().toString().padStart(2, '0') + 
                          now.getMinutes().toString().padStart(2, '0');
            const filename = `glossary_${dateStr}.json`;
            
            // –ò–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            
            showNotification(`–ì–ª–æ—Å—Å–∞—Ä–∏–π —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –∫–∞–∫ ${filename}`, 'success');
        }
        
        // –ü–æ–∏—Å–∫ —Ç–µ—Ä–º–∏–Ω–æ–≤ –≤ –≥–ª–æ—Å—Å–∞—Ä–∏–∏
        function searchTerm() {
            const searchInput = document.getElementById('searchInput');
            const searchTerm = searchInput.value.trim().toLowerCase();
            
            if (!searchTerm) {
                // –ï—Å–ª–∏ –ø–æ–ª–µ –ø–æ–∏—Å–∫–∞ –ø—É—Å—Ç–æ–µ, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ —Ç–µ—Ä–º–∏–Ω—ã
                renderTable(glossary.terms);
                return;
            }
            
            // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç–µ—Ä–º–∏–Ω–æ–≤ –ø–æ —Å—Ç—Ä–æ–∫–µ –ø–æ–∏—Å–∫–∞ (–ø–æ –æ—Ä–∏–≥–∏–Ω–∞–ª—É –∏ –ø–µ—Ä–µ–≤–æ–¥—É)
            const foundTerms = glossary.terms.filter(term => {
                return term.original.toLowerCase().includes(searchTerm) || 
                       term.translations.nominative.toLowerCase().includes(searchTerm);
            });
            
            // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Ç–∞–±–ª–∏—Ü—ã —Å –Ω–∞–π–¥–µ–Ω–Ω—ã–º–∏ —Ç–µ—Ä–º–∏–Ω–∞–º–∏
            renderTable(foundTerms);
            
            if (foundTerms.length === 0) {
                showNotification('–¢–µ—Ä–º–∏–Ω—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã', 'error');
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        function updateUI() {
            updateStatusBar();
            renderTable(glossary.terms);
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å-–±–∞—Ä–∞ (–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ñ–∞–π–ª–µ)
        function updateStatusBar() {
            const glossaryName = document.getElementById('glossaryName');
            const fileTime = document.getElementById('fileTime');
            
            if (glossary.terms && glossary.terms.length > 0) {
                // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–º —Ñ–∞–π–ª–µ
                if (currentFileName) {
                    glossaryName.textContent = currentFileName;
                    fileTime.textContent = currentFileTime;
                } else {
                    glossaryName.textContent = '–ë–µ–∑ –∏–º–µ–Ω–∏';
                    fileTime.textContent = '';
                }
                
                // –ü–æ–∫–∞–∑ —Ç–∞–±–ª–∏—Ü—ã –∏ —Å–∫—Ä—ã—Ç–∏–µ –ø—É—Å—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
                document.getElementById('tableHeader').style.display = 'flex';
                document.getElementById('tableContainer').style.display = 'block';
                document.getElementById('emptyState').style.display = 'none';
            } else {
                // –°–∫—Ä—ã—Ç–∏–µ —Ç–∞–±–ª–∏—Ü—ã –∏ –ø–æ–∫–∞–∑ –ø—É—Å—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
                glossaryName.textContent = '–ù–µ –∑–∞–≥—Ä—É–∂–µ–Ω';
                fileTime.textContent = '';
                document.getElementById('tableHeader').style.display = 'none';
                document.getElementById('tableContainer').style.display = 'none';
                document.getElementById('emptyState').style.display = 'block';
            }
        }
        
        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Ç–∞–±–ª–∏—Ü—ã —Å —Ç–µ—Ä–º–∏–Ω–∞–º–∏
        function renderTable(terms) {
            const tbody = document.getElementById('termsTableBody');
            tbody.innerHTML = ''; // –û—á–∏—Å—Ç–∫–∞ —Ç–∞–±–ª–∏—Ü—ã –ø–µ—Ä–µ–¥ –æ—Ç—Ä–∏—Å–æ–≤–∫–æ–π
            
            terms.forEach((term, index) => {
                // –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Ä–º–∏–Ω–∞
                const row = document.createElement('tr');
                row.id = `term-row-${index}`;
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Ç–µ—Ä–º–∏–Ω –Ω–æ–≤—ã–º (–µ—Å—Ç—å –ª–∏ –ø–æ–ª–µ source)
                const sourceText = getSourceText(term);
                const isNew = sourceText !== '';
                
                // –°–æ–∑–¥–∞–Ω–∏–µ —è—á–µ–µ–∫ —Å –¥–∞–Ω–Ω—ã–º–∏ —Ç–µ—Ä–º–∏–Ω–∞
                const cellOriginal = document.createElement('td');
                cellOriginal.textContent = term.original;
                
                const cellNominative = document.createElement('td');
                cellNominative.textContent = term.translations.nominative;
                
                const cellGenitive = document.createElement('td');
                cellGenitive.textContent = term.translations.genitive || '';
                
                const cellCategory = document.createElement('td');
                cellCategory.textContent = getCategoryName(term.category);
                
                const cellType = document.createElement('td');
                cellType.textContent = getTypeName(term.type);
                
                const cellNew = document.createElement('td');
                if (isNew) {
                    // –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –Ω–æ–≤–æ–≥–æ —Ç–µ—Ä–º–∏–Ω–∞
                    const indicator = document.createElement('div');
                    indicator.className = 'new-indicator';
                    indicator.title = sourceText;
                    indicator.textContent = 'üÜï';
                    cellNew.appendChild(indicator);
                }
                
                const cellActions = document.createElement('td');
                cellActions.className = 'action-cell';
                
                // –°–æ–∑–¥–∞–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π
                const actionsDiv = document.createElement('div');
                actionsDiv.className = 'action-buttons';
                
                const editBtn = document.createElement('button');
                editBtn.className = 'icon-btn edit';
                editBtn.title = '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å';
                editBtn.innerHTML = '‚úèÔ∏è';
                editBtn.onclick = function() { editTerm(index); };
                
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'icon-btn delete';
                deleteBtn.title = '–£–¥–∞–ª–∏—Ç—å';
                deleteBtn.innerHTML = 'üóëÔ∏è';
                deleteBtn.onclick = function() { deleteTerm(index); };
                
                // –°–±–æ—Ä–∫–∞ DOM-—Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å—Ç—Ä–æ–∫–∏
                actionsDiv.appendChild(editBtn);
                actionsDiv.appendChild(deleteBtn);
                cellActions.appendChild(actionsDiv);
                
                // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —è—á–µ–µ–∫ –≤ —Å—Ç—Ä–æ–∫—É
                row.appendChild(cellOriginal);
                row.appendChild(cellNominative);
                row.appendChild(cellGenitive);
                row.appendChild(cellCategory);
                row.appendChild(cellType);
                row.appendChild(cellNew);
                row.appendChild(cellActions);
                
                // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ –≤ —Ç–∞–±–ª–∏—Ü—É
                tbody.appendChild(row);
            });
        }
        
        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ç–µ—Ä–º–∏–Ω–∞
        function addNewTerm() {
            // –°–æ–∑–¥–∞–Ω–∏–µ –ø—É—Å—Ç–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ —Ç–µ—Ä–º–∏–Ω–∞
            const newTerm = {
                original: '',
                translations: {
                    nominative: '',
                    genitive: ''
                },
                category: '',
                type: '',
                source: {
                    file: '',
                    line: ''
                }
            };
            
            // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ç–µ—Ä–º–∏–Ω–∞ –≤ –Ω–∞—á–∞–ª–æ –º–∞—Å—Å–∏–≤–∞
            glossary.terms.unshift(newTerm);
            
            // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ñ–ª–∞–≥–∞, —á—Ç–æ —ç—Ç–æ –Ω–æ–≤—ã–π —Ç–µ—Ä–º–∏–Ω
            isNewTerm = true;
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏
            updateUI();
            
            // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è DOM –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ—Ö–æ–¥–æ–º –≤ —Ä–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            setTimeout(() => {
                editTerm(0); // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ (–Ω–æ–≤–æ–≥–æ —Ç–µ—Ä–º–∏–Ω–∞)
            }, 50);
        }
        
        // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–ª—è —Ç–µ—Ä–º–∏–Ω–∞
        function getSourceText(term) {
            if (term.source && term.source.file) {
                return `${term.source.file}:${term.source.line || ''}`;
            } else if (term.foundIn) {
                return term.foundIn;
            }
            return '';
        }
        
        // –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ –µ–µ –∫–æ–¥—É
        function getCategoryName(category) {
            const categories = {
                'quality': '–£—Ä–æ–≤–µ–Ω—å –∫–∞—á–µ—Å—Ç–≤–∞',
                'material': '–ú–∞—Ç–µ—Ä–∏–∞–ª',
                'base': '–ë–∞–∑–æ–≤—ã–π —Ç–∏–ø',
                'name': '–ò–º—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–µ'
            };
            return categories[category] || '--';
        }
        
        // –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Ç–∏–ø–∞ –ø–æ –µ–≥–æ –∫–æ–¥—É
        function getTypeName(type) {
            const types = {
                'item': '–ü—Ä–µ–¥–º–µ—Ç',
                'resource': '–†–µ—Å—É—Ä—Å',
                'creature': '–°—É—â–µ—Å—Ç–≤–æ',
                'char-name': '–ò–º—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞'
            };
            return types[type] || '--';
        }
        
        // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ—Ä–º–∏–Ω–∞ - –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤ —Ä–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        function editTerm(index) {
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –∏–Ω–¥–µ–∫—Å–∞
            if (index < 0 || index >= glossary.terms.length) {
                console.error('–ù–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–π –∏–Ω–¥–µ–∫—Å —Ç–µ—Ä–º–∏–Ω–∞:', index);
                return;
            }
            
            currentEditIndex = index;
            const term = glossary.terms[index];
            const row = document.getElementById(`term-row-${index}`);
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Å—Ç—Ä–æ–∫–∏ –≤ DOM
            if (!row) {
                console.error('–°—Ç—Ä–æ–∫–∞ —Ç–µ—Ä–º–∏–Ω–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞:', index);
                return;
            }
            
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤–æ–∑–º–æ–∂–Ω–æ–π –æ—Ç–º–µ–Ω—ã –∏–∑–º–µ–Ω–µ–Ω–∏–π
            row.dataset.originalData = JSON.stringify(term);
            
            // –ü–æ–ª—É—á–µ–Ω–∏–µ —è—á–µ–µ–∫ —Å—Ç—Ä–æ–∫–∏ –¥–ª—è –∑–∞–º–µ–Ω—ã –Ω–∞ –ø–æ–ª—è –≤–≤–æ–¥–∞
            const cells = row.querySelectorAll('td');
            
            // –ó–∞–º–µ–Ω–∞ —è—á–µ–µ–∫ –Ω–∞ –ø–æ–ª—è –≤–≤–æ–¥–∞/–≤—ã–±–æ—Ä–∞
            // –û—Ä–∏–≥–∏–Ω–∞–ª
            cells[0].innerHTML = `<input type="text" class="inline-edit" data-field="original" value="${term.original}">`;
            
            // –ü–µ—Ä–µ–≤–æ–¥ (–∏–º–µ–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂)
            cells[1].innerHTML = `<input type="text" class="inline-edit" data-field="nominative" value="${term.translations.nominative}">`;
            
            // –ü–µ—Ä–µ–≤–æ–¥ (—Ä–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂)
            cells[2].innerHTML = `<input type="text" class="inline-edit" data-field="genitive" value="${term.translations.genitive || ''}">`;
            
            // –ö–∞—Ç–µ–≥–æ—Ä–∏—è
            let categoryOptions = '<option value="">-- –ù–µ –≤—ã–±—Ä–∞–Ω–æ --</option>';
            ['quality', 'material', 'base', 'name'].forEach(cat => {
                const selected = cat === term.category ? 'selected' : '';
                categoryOptions += `<option value="${cat}" ${selected}>${getCategoryName(cat)}</option>`;
            });
            cells[3].innerHTML = `<select class="inline-select" data-field="category">${categoryOptions}</select>`;
            
            // –¢–∏–ø
            let typeOptions = '<option value="">-- –ù–µ –≤—ã–±—Ä–∞–Ω–æ --</option>';
            ['item', 'resource', 'creature', 'char-name'].forEach(type => {
                const selected = type === term.type ? 'selected' : '';
                typeOptions += `<option value="${type}" ${selected}>${getTypeName(type)}</option>`;
            });
            cells[4].innerHTML = `<select class="inline-select" data-field="type">${typeOptions}</select>`;
            
            // –ü–æ–ª–µ "–ù–æ–≤–æ–µ" (–∏—Å—Ç–æ—á–Ω–∏–∫)
            const sourceText = getSourceText(term);
            cells[5].innerHTML = `<input type="text" class="inline-edit" data-field="source" value="${sourceText}" placeholder="—Ñ–∞–π–ª:—Å—Ç—Ä–æ–∫–∞">`;
            
            // –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π (—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å/–æ—Ç–º–µ–Ω–∞)
            cells[6].innerHTML = `
                <div class="action-buttons">
                    <button class="icon-btn save" onclick="saveTerm(${index})" title="–°–æ—Ö—Ä–∞–Ω–∏—Ç—å">
                        üíæ
                    </button>
                    <button class="icon-btn cancel" onclick="cancelEdit(${index})" title="–û—Ç–º–µ–Ω–∞">
                        ‚ùå
                    </button>
                </div>
            `;
            
            // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ñ–æ–∫—É—Å–∞ –Ω–∞ –ø–µ—Ä–≤–æ–µ –ø–æ–ª–µ –≤–≤–æ–¥–∞
            setTimeout(() => {
                const firstInput = cells[0].querySelector('input');
                if (firstInput) {
                    firstInput.focus();
                }
            }, 10);
        }
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–µ—Ä–º–∏–Ω–∞
        function saveTerm(index) {
            const row = document.getElementById(`term-row-${index}`);
            if (!row) {
                console.error('–°—Ç—Ä–æ–∫–∞ —Ç–µ—Ä–º–∏–Ω–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏:', index);
                return;
            }
            
            // –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–ª–µ–π –≤–≤–æ–¥–∞ –≤ —Å—Ç—Ä–æ–∫–µ
            const inputs = row.querySelectorAll('.inline-edit, .inline-select');
            
            // –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Ç–µ—Ä–º–∏–Ω–∞
            const termData = {
                original: '',
                translations: {
                    nominative: '',
                    genitive: ''
                },
                category: '',
                type: '',
                source: {
                    file: '',
                    line: ''
                }
            };
            
            // –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ø–æ–ª–µ–π –≤–≤–æ–¥–∞
            inputs.forEach(input => {
                const field = input.dataset.field;
                if (field === 'original') {
                    termData.original = input.value.trim();
                } else if (field === 'nominative') {
                    termData.translations.nominative = input.value.trim();
                } else if (field === 'genitive') {
                    termData.translations.genitive = input.value.trim();
                } else if (field === 'category') {
                    termData.category = input.value;
                } else if (field === 'type') {
                    termData.type = input.value;
                } else if (field === 'source') {
                    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–ª—è –∏—Å—Ç–æ—á–Ω–∏–∫–∞ (—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ —Ñ–∞–π–ª –∏ —Å—Ç—Ä–æ–∫—É)
                    const sourceValue = input.value.trim();
                    if (sourceValue.includes(':')) {
                        const parts = sourceValue.split(':');
                        termData.source.file = parts[0].trim();
                        termData.source.line = parts[1].trim();
                    } else {
                        termData.source.file = sourceValue;
                        termData.source.line = '';
                    }
                }
            });
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
            if (!termData.original || !termData.translations.nominative) {
                showNotification('–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –æ—Ä–∏–≥–∏–Ω–∞–ª –∏ –ø–µ—Ä–µ–≤–æ–¥', 'error');
                return;
            }
            
            // –£–¥–∞–ª–µ–Ω–∏–µ –ø—É—Å—Ç–æ–≥–æ –ø–æ–ª—è –∏—Å—Ç–æ—á–Ω–∏–∫–∞
            if (!termData.source.file && !termData.source.line) {
                delete termData.source;
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ—Ä–º–∏–Ω–∞ –≤ –º–∞—Å—Å–∏–≤–µ
            glossary.terms[index] = termData;
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö (–≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è)
            glossary.metadata.last_updated = new Date().toISOString();
            
            // –°–±—Ä–æ—Å —Ñ–ª–∞–≥–∞ –Ω–æ–≤–æ–≥–æ —Ç–µ—Ä–º–∏–Ω–∞
            isNewTerm = false;
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
            updateUI();
            showNotification('–¢–µ—Ä–º–∏–Ω —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω', 'success');
        }
        
        // –û—Ç–º–µ–Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ—Ä–º–∏–Ω–∞
        function cancelEdit(index) {
            // –ï—Å–ª–∏ —ç—Ç–æ –Ω–æ–≤—ã–π —Ç–µ—Ä–º–∏–Ω –∏ –æ–Ω –ø—É—Å—Ç–æ–π, —É–¥–∞–ª—è–µ–º –µ–≥–æ
            if (isNewTerm) {
                const term = glossary.terms[index];
                if (!term.original && !term.translations.nominative && 
                    (!term.source || (!term.source.file && !term.source.line))) {
                    glossary.terms.splice(index, 1);
                    isNewTerm = false;
                    updateUI();
                    return;
                }
            }
            
            const row = document.getElementById(`term-row-${index}`);
            if (!row) {
                console.error('–°—Ç—Ä–æ–∫–∞ —Ç–µ—Ä–º–∏–Ω–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ:', index);
                return;
            }
            
            // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ –∞—Ç—Ä–∏–±—É—Ç–∞ dataset
            if (row.dataset.originalData) {
                const originalData = JSON.parse(row.dataset.originalData);
                glossary.terms[index] = originalData;
            }
            
            // –°–±—Ä–æ—Å —Ñ–ª–∞–≥–∞ –Ω–æ–≤–æ–≥–æ —Ç–µ—Ä–º–∏–Ω–∞
            isNewTerm = false;
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –∫ —Ä–µ–∂–∏–º—É –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
            updateUI();
        }
        
        // –£–¥–∞–ª–µ–Ω–∏–µ —Ç–µ—Ä–º–∏–Ω–∞
        function deleteTerm(index) {
            // –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ç–µ—Ä–º–∏–Ω?')) {
                // –£–¥–∞–ª–µ–Ω–∏–µ —Ç–µ—Ä–º–∏–Ω–∞ –∏–∑ –º–∞—Å—Å–∏–≤–∞
                glossary.terms.splice(index, 1);
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
                glossary.metadata.last_updated = new Date().toISOString();
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
                updateUI();
                showNotification('–¢–µ—Ä–º–∏–Ω —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω', 'success');
            }
        }
        
        // –ü–æ–∫–∞–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
        function showNotification(message, type = 'success') {
            // –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
            const prevNotifications = document.querySelectorAll('.notification');
            prevNotifications.forEach(n => n.remove());
            
            // –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫—Ä—ã—Ç–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }
    </script>
</body>
</html>
